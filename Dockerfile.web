FROM node:20-alpine

WORKDIR /app
RUN corepack enable && corepack prepare pnpm@9 --activate

COPY package.json pnpm-workspace.yaml ./
COPY web/package.json ./web/
RUN pnpm install --frozen-lockfile || pnpm install

COPY . .
EXPOSE 5173
CMD ["pnpm", "--filter", "web", "dev"]
